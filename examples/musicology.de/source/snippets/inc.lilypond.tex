% mycsrf 'for beeing included' snippet template
%
% (c) Karsten Reincke, Frankfurt a.M. 2012, ff.
%
% This text is licensed under the Creative Commons Attribution 3.0 Germany
% License (http://creativecommons.org/licenses/by/3.0/de/): Feel free to share
% (to copy, distribute and transmit) or to remix (to adapt) it, if you respect
% how you must attribute the work in the manner specified by the author(s):
% \newline
% In an internet based reuse please link the reused parts to mycsrf.fodina.de
% and mention the original author Karsten Reincke in a suitable manner. In a
% paper-like reuse please insert a short hint to mycsrf.fodina.de and to the
% original author, Karsten Reincke, into your preface. For normal quotations
% please use the scientific standard to cite
%


%% use all entries of the bibliography

\section{Lilypond: komplex, elegant und schön ($\bigstar\bigstar\bigstar\bigstar\bigstar$)}
\label{LilyPondBackend}
\parpic(2cm,1.4cm)[r][t]{\includegraphics[width=2cm]{logos/lilypond-300dpi.png}}
\textit{LilyPond} möchte guten \enquote{Notensatz für jedermann} anbieten: Als
elektronisches \enquote{Notensatzsystem} -- so das Entwicklungsteam -- wolle es
\enquote{[\ldots] Notendruck in (bester) Qualität} ermöglichen, mithin
\enquote{[\ldots] die Ästhetik handgestochenen traditionellen Notensatzes mit
computergesetzten Noten [\ldots] erreichen}.\footnote{\cite[vgl.][\nopage
wp.]{LilyPond2018a}. Lizensiert ist \acc{LiyPond} unter der GPL $\rightarrow$
\href{http://lilypond.org/gpl.html}{http://lilypond.org/gpl.html}, einer
anerkannten Open-Source-Lizenz ($\rightarrow$
\href{https://opensource.org/licenses/GPL-2.0}
{https://opensource.org/licenses/GPL-2.0}). } In einem besonderen Artikel haben
die LilyPond-Entwickler dargestellt, was das systemisch
bedeutet\footcite[vgl.][5ff]{LilyPond2018d} und welchen Konsequenzen sich daraus
für ein Notensatzprogramm ergeben.\footcite[vgl.][8ff]{LilyPond2018d} Der daraus
erwachsende Anspruch ist hoch:

\begin{quote}\textit{\enquote{LilyPond wurde geschaffen, um die Probleme zu
lösen, die wir in existierenden Programmen gefunden haben und um schöne Noten zu
schaffen, die die besten handgestochenen Partituren
imitieren.}\footcite[vgl.][2]{LilyPond2018d} }
\end{quote}

Wer die entsprechenden Techniken erfolgreich anwenden will, kann auf ein einfach
strukturiertes Lerntutorial\footcite[vgl.][20ff]{LilyPond2018b} und ein kürzeres
Nutzungshandbuch\footcite[vgl.][1ff]{LilyPond2018e} zurückgreifen. Letztlich
wird er sich allerdings auch das umfangreiche
Notationshandbuch\footcite[vgl.][1ff]{LilyPond2018c} bereitlegen wollen.

Wie die bisher diskutierten Systeme erwartet \textit{LilyPond}, dass man Code
schreibt, keine Noten: Hier wie da ist der Texteditor das bevorzugte Werkzeug,
um Musik im entsprechenden 'Dialekt' zu notieren. Trotzdem gibt es Unterschiede,
die über die bloße Syntax hinausgehen:

Die wichtigste Eigenart dürfte sein, dass Lilypond konsequent zwischen Musik und
Druck unterscheidet: Wer in D-Dur ein \textit{fis} einfügen möchte, kann sich
hier nicht auf die zu Beginn spezifizierte Tonart 'berufen', er muss trotzdem
\texttt{fis} tippen, nicht \texttt{f}, und zwar an jeder Stelle, wo er
\textit{fis} meint. Diese Abkehr von der musikalischen Tradition hat einen
gewichtigen Vorteil: Lilypond kann bei Alterationen die nötigen Vorzeichen
automatisch setzen. In \textit{g-moll} erhält die Note \textit{f} bei
eingegebenem \texttt{fis} automatisch ein Kreuz, in D-Dur
nicht.\footnote{\cite[vgl.][21]{LilyPond2018b}. In der Konsequenz wird man sich
allerdings auch an -- wenigstens für Deutsche -- überraschende 'Töne' wie
\texttt{bes}, \texttt{beses} oder \texttt{bis} gewöhnen müssen.}

'Augenfällig' ist zudem, dass \textit{LilyPond} seine Elemente konsequent in
einer 1:n-Beziehung anordnet: Das Notenheft besteht aus einem oder mehreren
Stücken, das Stück besteht aus einem oder mehreren Notensystemen, ein
Notensystem besteht aus einer oder mehrerer Stimmen, die Stimme kann solistisch
oder akkordisch sein. Das Datenmodell ist mithin als Baum\footcite[vgl.][\nopage
wp.]{WpedBaum2019a} ausgelegt. Und syntaktisch haben die Ebenen je eigene
Markanten. Das macht das Lesen und Verstehen von \textit{LilyPond}-Code auf
Dauer einfacher, es entsteht ein klarerer
Sourcetext.\footcite[vgl.][40ff]{LilyPond2018b}

Systemisch gesehen hat LilyPond (heute) nichts (mehr) \LaTeX\ , MusiX\TeX\ oder
\TeX\ zu tun: es nutzt seine eigene Eingabesprache und seine eigene Maschine zum
Erzeugen des Notenbildes: Als \enquote{Standardausgabeformat} -- heißt es --
seien \textit{PDF}\footnote{Portable Document Format} und
\textit{PS}\footnote{Postscript} gesetzt; außerdem könnten
\textit{SVG\footnote{Scalable Vector Graphics}-}, \textit{EPS\footnote{Encapsulated
PostScript}-} und \textit{PNG\footnote{Portable Network Graphics}-}Dateien erzeugt
werden.\footcite[vgl.][481]{LilyPond2018c}

\subsection{Technische Voraussetzungen}

\textit{LilyPond} sagt selbst, dass man Notenbeispiele in Form von Graphiken auch
manuell in den \LaTeX-Text einfügen könne, einfach indem man -- zuerst und
unabhängig von \LaTeX\ -- die Graphiken mit \texttt{lilypond} erzeuge und sie
danach mit \LaTeX-Mitteln einbinde.\footcite[vgl.][20]{LilyPond2018e} Bei vielen
Notenbeispielen kann das allerdings aufwendig werden, insbesondere, wenn man
manuell die Länge der Notenzeilen und die Graphikbreite auf die gewünschte
Zeilenlänge des Dokumentes ausrichten muss.

Deshalb bietet \textit{LilyPond} nicht nur das Tool \texttt{lilypond} zur
Erzeugung ganzer Notenblätter in den genannten Formaten an\footnote{samt aller
anderen Outputformate wie \textit{midi} u.Ä.m.}, sondern auch das Tool
\texttt{lilypond-book}: dieses \enquote{automatisiert} die manuelle Integration,
indem es die \enquote{[\ldots] Musik-Schnipsel aus Ihrem Dokument (extrahiert),
[\ldots] \texttt{lilypond} (aufruft) und [\ldots] die resultierenden Bilder in
Ihr Dokument (einfügt)}, wobei es \enquote{[\ldots] die Länge der Zeilen und die
Schriftgröße dabei [automatisch] (dem) Dokument
(anpasst)}.\footcite[vgl.][20]{LilyPond2018e}

Daraus folgt sofort, dass man auch hier einiges vorzubereiten hat, wenn man
\textit{LilyPond} erfolgreich verwenden will:

$\RHD$ Zunächst muss man -- ganz unabhängig von \LaTeX\ -- \textit{LilyPond}
installieren\footnote{Unter Ubuntu: \texttt{sudo apt-get install lilypond
lilypond-data}}. Dieses Paket stellt dann auch \texttt{lilypond-book} bereit.
  
$\RHD$ Im Gegensatz zu \textit{ABC} oder \textit{MusiX\TeX} braucht
\acc{LilyPond} nicht in der \LaTeX-Präambel aktiviert zu werden. Denn
\texttt{lilypond-book} muss ja immer vor und unabhängig von \LaTeX\
aufgerufen werden: Es generiert erst den eigentlichen \LaTeX-Code, der dann
keine \textit{LilyPond}-Sektionen mehr enthält. Also kann man -- direkt nach der
Installation -- den \textit{LilyPond}-Quelltext eines jeden Notenbeispiels in je
einer eigenen (virtuellen) Umgebung \verb|\begin{lilypond}...\end{lilypond}|
editieren. Virtuell sind diese Umgebungen insofern, als \LaTeX\ ja nichts von
\textit{LilyPond} weiß.

$\RHD$ Schließlich muss man noch organisieren, dass den eigentlichen
\LaTeX-Durchgängen zur Generierung der PDFs ein \texttt{lilypond-book}-Aufruf
vorausgeht. Das kann wieder in einem Makefile organisiert werden.

Leider steckt der Teufel dabei -- wie so oft -- im Detail: 

\label{LilyPondGraphics}\texttt{lilypond-book} nimmt eine -- wie wir jetzt
wissen -- gewissermaßen 'unechte' \LaTeX-Datei, die noch
\textit{lilypond}-Sektionen enthält, und erzeugt die entsprechenden Graphiken,
bevor es die \textit{lilypond}-Sektionen durch die korrespondierenden
'include-Graphik'-Befehle auf \LaTeX-Ebene ersetzt. Das ist der Grund, warum
\texttt{lilypond-book} immer als erstes prozessiert werden muss.

Ruft man \texttt{lilypond-book} ohne weitere Parameter für eine ('unechte')
\LaTeX-Datei mit der Extension \textit{.tex} auf, beschwert es sich, dass es seine
Inputdatei überschreiben müsste und verweigert die Weiterarbeit. Dies wird
gelöst, indem man es mit der Option \texttt{--out IHRDIR} aufruft. Dann erzeugt
\texttt{lilypond-book} einen Ordner names \textit{IHRDIR} und sammelt darin
alle Materialien ein, die es für eine \LaTeX-compilierbare Version benötigt.

Unglücklicherweise muss man \texttt{lilypond-book} dabei ein wenig unter die Arme
greifen:

Tatsächlich evaluiert und bearbeitet \texttt{lilypond-book} erfolgreich alle
Dateien mit der Extension \textit{.tex}, insbesondere auch die, die per
\textit{input}-Befehl in die Hauptdatei eingebunden worden sind. Die Aufteilung
eines LaTeX-Textes in mehrere 'Snippets' bedeutet für \texttt{lilypond-book} kein
Problem. Und \texttt{lilypond-book} kopiert auch alle gefundenen Daten -- ggfls.
überarbeitet -- korrekt in den Arbeitsordner, den man dem Tool auf der
Kommandozeile mit gegeben hat, und zwar unter Beibehaltung der Ordnerstrukturen,
sodass die include-Referenzen in den kopierten Dateien nicht ins Leere zeigen.
Gleichwohl gibt es Dateien, die nicht in den Blick von \texttt{lilypond-book}
geraten und die es darum auch nicht mit in den Arbeitsordner übernimmt. Trotzdem
werden natürlich auch diese Dateien benötigt, wenn man innerhalb des
Arbeitsordners erfolgreich einen \LaTeX-Lauf starten will. Prominentestes
Beispiel für solche Dateien sind die \textit{bib-Files} und ausgelagerte
Konfigurationsdateien.

Deshalb muss der \LaTeX-User als Nutzer von \texttt{lilypond-book} -- sozusagen
manuell -- die fehlenden Dateien in den von \texttt{lilypond-book} erzeugten
Arbeitsordner kopieren, bevor er den 'normalen' \LaTeX-Erzegungsprozess aufruft.

Eine entsprechendes Makefile könnte so aussehen:

\begin{verbatim}

# source directory
SRCD=source
# lilypond working directory
LPWD=lily

prod: 
  # (1) create a copy of your source directory as lilypond directory 
  @ cp -rd ${SRCD} ${LPWD}
  # (2) change into the lilypond directory and call lilypond for your
  #     file & let the results be written into a temporary directory
  @ ( cd ${LPWD} && lilypond-book --out ../tmp your-latex-file.tex )
  # (3) lilypond has created & collected the sources it needs into the 
  #     tmp dir but unfortunatelay not all. Hence, 
  #     the missed parts must still be copied into that tmp dir manually
  # (4.a) ensure that all dirs really exist we need
  @ mkdir -p  tmp/bib/ tmp/cfg tmp/pics
  # (4.b) ensure that also the missed files can be found in the tmp dir
  @ cp -rd ${SRCD}/bib/* tmp/bib/
  @ cp -rd ${SRCD}/cfg/* tmp/cfg/
  @ cp ${SRCD}/Makefile tmp/
  ( cd tmp && make your-latex-file.pdf && mv your-latex-file.pdf ../ )
  rm -rf ${LPWD}
  rm -rf tmp

\end{verbatim}


\subsection{Kadenz I}
\label{LilyPondKadenzI}
Und damit dürfen wir die Früchte der Vorarbeit ernten: Es ist bereits
absehbar, dass die eigentliche Herausforderung zuletzt nicht mehr die Nutzung
von \textit{LilyPond} als solches sein wird, sondern die Einbindung jener
Symbole in den Notentext, die für den Musikwissenschaftler so wichtig sind.
\textit{LilyPond} selbst bietet 3 Verfahren an, (echten) Text in die Noten zu
integrieren:

\begin{enumerate}
  \item Man darf 'Liedtext' unter ein Notensystem setzen, wobei als Text dort
  auch -- in einfacher Form  -- Analysesymbole erscheinen können.
  können.\footcite[vgl.][31ff]{LilyPond2018b}
  \item Man darf Makros mit Text an Noten anhängen, die dann -- je nach
  Vorzeichen '\texttt{\_}' oder '\texttt{\^}' über oder unter der Note
  erscheinen. Diese Makros gibt es in einer verkürzten und einer expliziten
  Version. Beide sind Sonderfälle einer generellen
  Markupsprache.\footcite[vgl.][211ff]{LilyPond2018c}
  \item Man darf komplexer strukturierte Syntagmen der erwähnten generalisierten
  Markupsprache an Noten anhängen, mit denen es dann auch möglich wird, feinere
  Texte differenziert zu gestalten und
  einzufügen.\footcite[vgl.][218ff]{LilyPond2018c} 
\end{enumerate}

Dabei wird der Musikwissenschaftler nicht auf die \LaTeX-Sonderzeichen oder die
schönen \textit{harmony}-Konstrukte zurückgreifen können. Denn \textit{LilyPond}
arbeitet ja \LaTeX-unabhängig. Also wird über die Brauchbarkeit von
\textit{LilyPond} letzlich die Frage entscheiden, ob und wie gut man die Symbole
der Harmonieanalyse, die \textit{harmony} bereitstellt, mit den Mitteln von
\textit{LilyPond} nachbilden kann und welcher Aufwand dabei entsteht.

Gehen wir diese Dinge der Reihe nach durch, beginnend -- wie kaum anders zu
erwarten -- mit der einzeiligen
Grabner-Kadenz\footcite[vgl.][107]{Grabner1974a}: Die ersten beiden Akkorde sind
mit einfachen Markups klassifiziert, der dritte mit der entsprechenden
abgekürzten Version. Und unter den letzten drei Akkorden sind die Symbole als
'Liedtext' eingefügt worden:

\begin{center}
\begin{lilypond}
\version "2.18.2"
\header { tagline = "" }
\score {
  \new Staff {
    \relative c' { 
      \time 3/1
      <c e g>1 _\markup {I} ^\markup {T}
      <f a c>  _\markup {IV} ^\markup {S}
      <g b d>  _"V" ^"D"
      |
      {	<< 
      	  {
            <a, c e>  ^"T"
            <d f a>   ^"S"
            <e gis b> ^"D"
          }
          \addlyrics {
          	I IV V
          }
        >>
      }
      \bar "||"
    }   
  }
  \layout {
    \context {
      \Staff
        \remove Time_signature_engraver
    }
  }
}
\end{lilypond}
\cad{I}{LilyPond}
\end{center}

Man sieht, dass die einfacheren Markup-Konstrukte noch auf einer Linie
ausgerichtet werden müssten. Das ist bei der Methode 'Liedtext' schon implizit --
im Rahmen der Implementation --  erledigt worden. Der zugehörige Quellcode sieht
so aus:
\begin{verbatim}
\begin{lilypond}
\version "2.18.2"
\header { tagline = "" }
\score {
  \new Staff {
    \relative c' { 
      \time 3/1
      <c e g>1 _\markup {I} ^\markup {T}
      <f a c>  _\markup {IV} ^\markup {S}
      <g b d>  _"V" ^"D"
      |
      { << 
          {
            <a, c e>  ^"T"
            <d f a>   ^"S"
            <e gis b> ^"D"
          }
          \addlyrics {
            I IV V
          }
        >>
      }
      \bar "||"
    }   
  }
  \layout {
    \context {
      \Staff
        \remove Time_signature_engraver
    }
  }
}
\end{lilypond}
\end{verbatim}

An diesem Code erkennt man gut die systematische 1:n-Struktur eines
\textit{LilyPond}-Quelltextes: Der \texttt{score} hat eine Stimme
(\texttt{staff}). All ihre Noten beziehen sich sich auf \texttt{c'}. Und sie hat
vier Abschnitte, nämlich drei Akkorde \texttt{< \ldots\ >}, gefolgt von einer
strukturierten Einheit. Dieser Komplex besteht seinerseits aus zwei Teilen, die
'gleichzeitig' (= übereinander) abgedruckt werden sollen: nochmals 3 Akkorde und
die 3 Symbole, die darunter erscheinen.

Es zeigt sich aber auch, dass die naheliegenden Methoden,
Funktionsanalysesymbole in die Noten zu integrieren, inhaltlich gesehen nicht
ausdrucksreich genug sind und optisch nicht zufrieden stellen. Hier wird man
etwas tun müssen. 

\subsection{Kadenz II}

\textit{LilyPond} ist nicht nur 'waschechte' \textit{Open-Source-Software},
sondern kommt zudem mit einer Erweiterungssprache daher.\footcite[vgl.
dazu][\nopage wp.]{WpedGuile2019a} Diese zu nutzen, um die Möglichkeiten des
\LaTeX-Paketes \textit{harmony} nachzubilden, artet jedoch in echte
Programmierarbeit aus und dürfte einem Musikwissenschaftler kaum mehr zuzumuten
sein - wohl aber denen, die in beiden Welten zuhause ist, also uns.

\label{LilyPondFuncTheory}Um \acc{LilyPonds} bisherigen Mangel in Sachen
musikwissenschaftlicher Kennzeichnung auszugleichen, haben wir also begonnen,
eine \textit{LilyPond}-Library zu entwickeln, die man einfach in seine
\textit{LilyPond}-Datei mit dem Befehl \texttt{\textbackslash{include}}
hinzulädt. Sie sollte im wesentlichen dieselbe Funktionalität für \acc{LilyPond}
bereitstellen, die man via \acc{Harmony} in \LaTeX\ und Musix\TeX\ verwenden
kann.\footnote{\ra\ S.\pageref{Harmony}} Und aus Respekt vor der Vorlage sollte
diese Bibliothek \acc{Harmonyli} heißen, was als \acc{LilyPond}-Datei -- nicht
ganz unabsichtlich -- zu dem Namen \texttt{harmonyli.ly} führt.\footnote{\ra\
\lnka{https://github.com/kreincke/harmonyli.ly}} Mittlerweile dürfen wir sagen,
dass sich diese Bibliothek -- auch und gerade dank der Unterstützung durch die
Community -- zu einem musikwissenschaftlichen Tool entwickelt hat, dass über die
Fähigkeiten von \acc{Harmony} hinausgeht und mindestens ebenso gut dokumentiert
ist.\footcite[vgl.][1ff]{Reincke2019b}

Hat man diese Bibliothek eingebunden, kann man die entsprechende Symbole der
Harmonieanalyse in seinen Notentext hinzufügen und folgendes Notenbild erzeugen:

\begin{center}
\begin{lilypond}
\version "2.18.2"

\header { tagline = "" }
\include "lilypond/harmonyli.ly"
  
\score {
  \new StaffGroup {
    \time 4/4
    <<
      \new Staff {
        \relative d' {
       	  \clef "treble" \key d \major  \stemUp
          < fis d'>2 < fis dis'>2 < b e>2 < b eis>2 | 
          < b fis'>2 < e gis >2 < e a >4 < e a >4 < a fis>2  \bar "||"
        }
        \addlyrics {
          \markup \setHas "T" #'(("C"."D")("fr" . " "))
          \markup \setImHas "D" #'(("B"."1")("a" . "7")("fr" . " "))
          \markup \setHas "Sp" #'(("B"."7")("a" . "7")("fl" . " ")("fr" . " "))
          \markup \setHas "D" #'(("T"."x")("B"."3")("a" . "5")("b" . "7")("c" . "♭9>♯8")("fr" . " "))
          \markup \setHas "Tp" #'(("B"."3")("fl" . " ")("fr" . " ")) 
          \markup \setHas "D" #'(("T"."d")("B"."5")("a" . "7")("b" . "8")("fr" . " "))                  
          \initTextSpan "   "
          \markup \openZoomRow "D" #'(("a"."4")("fl" . " "))
          \startTextSpan
          \markup \expZoomRow #'(("a"."3")("fr" . " ")) 
          \stopTextSpan  
          \markup \setHas "T" #'(("fr" . " "))
        }   
      }
      \new Staff {
        \relative d { 
          \clef "bass" \key d \major \stemDown
          < d a'>2 < b a'>2 < d g>2 < cis g'>2 |
          < d fis>2 < b d>2 << { a4( a4) } { d4( cis4) } >> < d, d'>2 \bar "||"
        }   
      }
    >>
  }
  \layout {
    \context { \Lyrics \consists "Text_spanner_engraver" }
  }
  \midi {}
}

\end{lilypond}
\cad{II}{LilyPond}
\end{center}

Der entsprechende \textit{Lilypond}-Code sähe dann so aus:
 \begin{scriptsize}
\begin{verbatim}
\begin{lilypond}
\version "2.18.2"

\header { tagline = "" }
\include "lilypond/harmonyli.ly"
  
\score {
  \new StaffGroup {
    \time 4/4
    <<
      \new Staff {
        \relative d' {
          \clef "treble" \key d \major  \stemUp
          < fis d'>2 < fis dis'>2 < b e>2 < b eis>2 | 
          < b fis'>2 < e gis >2 < e a >4 < e a >4 < a fis>2  \bar "||"
        }
        \addlyrics {
          \markup \setHas "T" #'(("C"."D")("fr" . " "))
          \markup \setImHas "D" #'(("B"."1")("a" . "7")("fr" . " "))
          \markup \setHas "Sp" #'(("B"."7")("a" . "7")("fl" . " ")("fr" . " "))
          \markup \setHas "D" #'(("T"."x")("B"."3")("a" . "5")("b" . "7")("c" . "-9>+8")("fr" . " "))
          \markup \setHas "Tp" #'(("B"."3")("fl" . " ")("fr" . " ")) 
          \markup \setHas "D" #'(("T"."d")("B"."5")("a" . "7")("b" . "8")("fr" . " "))                  
          \initTextSpan "   "
          \markup \openZoomRow "D" #'(("a"."4")("fl" . " "))
          \startTextSpan
          \markup \expZoomRow #'(("a"."3")("fr" . " ")) 
          \stopTextSpan  
          \markup \setHas "T" #'(("fr" . " "))
        }   
      }
      \new Staff {
        \relative d { 
          \clef "bass" \key d \major \stemDown
          < d a'>2 < b a'>2 < d g>2 < cis g'>2 |
          < d fis>2 < b d>2 << { a4( a4) } { d4( cis4) } >> < d, d'>2 \bar "||"
        }   
      }
    >>
  }
  \layout {
    \context { \Lyrics \consists "Text_spanner_engraver" }
  }
  \midi {}
}

\end{lilypond}
\end{verbatim}
\end{scriptsize}

\subsection{Kadenz III}

Und so fehlt noch die dritte Kadenz in der Version, die \textit{LilyPond} unter
Nutzung der Bibliothek \acc{karmonyli.ly} erzeugen kann:

\begin{lilypond}
\version "2.18.2"
\header { tagline = "" }
\include "lilypond/harmonyli.ly"

\score {
  \new StaffGroup {
    \time 5/8
    <<
      \new Staff {
        \relative c'' {
          \clef "treble" \key bes \major  \stemUp
          <bes d f>4 <c  es f>4 <bes es bes'>8 |
          <c es a >4 <a f' a>4 <c es f >8 |         
          r8 <f, d' f>8 <a  c  es>8 <f bes d>4 |
          r8 <es a c>4 <es a  c>4|
          r8 <es a c>8 <c' es f>8 <bes d f>4 |
          r8  <g bes c>8 <es a c>8 <d f bes>4
        }   
      }
      \new Staff {
        \relative c { 
          \clef "bass" \key bes \major \stemDown
            bes8[ bes'] a[ as] g16.[ ges32] |
            f8[ es] d8.[ des16] c16.[ a32] | 
            bes4  f'8 bes4 |
            r8 f8 c f,4  | 
            r8 f' a,8 bes4 | 
            r8  es8 f bes4 \bar "||"
        }   
      }
      \new RhythmicStaff {
        c4 c8[ c8] c16.[ c32] | c8[ c8] c8.[ c16] c16.[ c32] | 
        c4 c8 c4 | r8 c2 | r8 c8 c8 c4 | r8 c8 c8 c4 |
      }
      \addlyrics{
        \markup \setHas "T" #'(("C"."B")("fr" . " "))
        \initTextSpan "   "
        \markup \openZoomRow "D" #'(("B"."3")("a"."3")("b"."7")("c"."8")("fl" . " "))
        \startTextSpan
        \markup \expZoomRow #'(("a"."3-")("fr" . " ")) 
        \stopTextSpan
        \initTextSpan "   "
        \markup \openZoomRow "S" #'(("B"."3")("a"."3")("fl" . " "))
        \startTextSpan
        \markup \expZoomRow #'(("a"."3-")("fr" . " ")) 
        \stopTextSpan
        \initTextSpan "   "
        \markup \openZoomRow "D" #'(("B"."1")("a"."1")("b"."7")("c"."8")("fl" . " "))
        \startTextSpan
        \markup \expZoomRow #'(("a"."7")("fr" . " ")) 
        \stopTextSpan
        \initTextSpan "   "
        \markup \openZoomRow "Dp" #'(("B"."3")("a"."3")("fl" . " "))
        \startTextSpan
        \markup \expZoomRow #'(("a"."3-")("fr" . " ")) 
        \stopTextSpan
        \initTextSpan "   "
        \markup \openZoomRow "D" #'(("B"."5")("a"."5")("b"."7")("fl" . " "))
        \startTextSpan
        \markup \expZoomRow #'(("a"."3")("fr" . " ")) 
        \stopTextSpan    
        \markup \setHas "T" #'()
        \markup \setHas "D" #'(("a"."7"))
        \markup \setHas "T" #'()
        \markup \setHas "D" #'(("a"."7"))
        \markup \setHas "D" #'(("a"."7"))
        \markup \setHas "D" #'(("B"."3")("a"."7"))
        \markup \setHas "T" #'()
        \markup \setHas "S" #'(("a"."5")("b"."6"))
        \markup \setHas "D" #'(("a"."7"))
        \markup \setHas "T" #'()
        }
    >>
  }
  \layout { \context { \Lyrics \consists "Text_spanner_engraver" } }
}

\end{lilypond}

Für diese ist folgender Quellcode zuständig:
\begin{scriptsize}


\begin{verbatim}
\begin{lilypond}
\version "2.18.2"
\header { tagline = "" }
\include "lilypond/harmonyli.ly"

\score {
  \new StaffGroup {
    \time 5/8
    <<
      \new Staff {
        \relative c'' {
          \clef "treble" \key bes \major  \stemUp
          <bes d f>4 <c  es f>4 <bes es bes'>8 |
          <c es a >4 <a f' a>4 <c es f >8 |         
          r8 <f, d' f>8 <a  c  es>8 <f bes d>4 |
          r8 <es a c>4 <es a  c>4|
          r8 <es a c>8 <c' es f>8 <bes d f>4 |
          r8  <g bes c>8 <es a c>8 <d f bes>4
        }   
      }
      \new Staff {
        \relative c { 
          \clef "bass" \key bes \major \stemDown
            bes8[ bes'] a[ as] g16.[ ges32] |
            f8[ es] d8.[ des16] c16.[ a32] | 
            bes4  f'8 bes4 |
            r8 f8 c f,4  | 
            r8 f' a,8 bes4 | 
            r8  es8 f bes4 \bar "||"
        }   
      }
      \new RhythmicStaff {
        c4 c8[ c8] c16.[ c32] | c8[ c8] c8.[ c16] c16.[ c32] | 
        c4 c8 c4 | r8 c2 | r8 c8 c8 c4 | r8 c8 c8 c4 |
      }
      \addlyrics{
        \markup \setHas "T" #'(("C"."B")("fr" . " "))
        \initTextSpan "   "
        \markup \openZoomRow "D" #'(("B"."3")("a"."3")("b"."7")("c"."8")("fl" . " "))
        \startTextSpan
        \markup \expZoomRow #'(("a"."3-")("fr" . " ")) 
        \stopTextSpan
        \initTextSpan "   "
        \markup \openZoomRow "S" #'(("B"."3")("a"."3")("fl" . " "))
        \startTextSpan
        \markup \expZoomRow #'(("a"."3-")("fr" . " ")) 
        \stopTextSpan
        \initTextSpan "   "
        \markup \openZoomRow "D" #'(("B"."1")("a"."1")("b"."7")("c"."8")("fl" . " "))
        \startTextSpan
        \markup \expZoomRow #'(("a"."7")("fr" . " ")) 
        \stopTextSpan
        \initTextSpan "   "
        \markup \openZoomRow "Dp" #'(("B"."3")("a"."3")("fl" . " "))
        \startTextSpan
        \markup \expZoomRow #'(("a"."3-")("fr" . " ")) 
        \stopTextSpan
        \initTextSpan "   "
        \markup \openZoomRow "D" #'(("B"."5")("a"."5")("b"."7")("fl" . " "))
        \startTextSpan
        \markup \expZoomRow #'(("a"."3")("fr" . " ")) 
        \stopTextSpan    
        \markup \setHas "T" #'()
        \markup \setHas "D" #'(("a"."7"))
        \markup \setHas "T" #'()
        \markup \setHas "D" #'(("a"."7"))
        \markup \setHas "D" #'(("a"."7"))
        \markup \setHas "D" #'(("B"."3")("a"."7"))
        \markup \setHas "T" #'()
        \markup \setHas "S" #'(("a"."5")("b"."6"))
        \markup \setHas "D" #'(("a"."7"))
        \markup \setHas "T" #'()
        }
    >>
  }
  \layout { \context { \Lyrics \consists "Text_spanner_engraver" } }
}

\end{lilypond}
\end{verbatim}
\end{scriptsize}

\subsection{Bewertung}

Vergleicht man das 'Druckbild', das \textit{LilyPond} erzeugt, mit den Noten,
die MusiX\TeX\ im Verbund mit \LaTeX\ generiert, fällt in der Tat auf, dass die
\textit{LilyPond}-Noten irgendwie 'weicher', 'dichter' und lesbarer sind:
\textit{LilyPond} wollte die Qualität des guten manuellen Notensatzes in den
elektronische Notensatz einbringen.\footcite[vgl.][8ff]{LilyPond2018d} Das ist
gelungen: auch wenn sich \textit{MusiX\TeX} und \textit{LilyPond} von der
graphischen Erscheinung her nicht viel geben -- den Output eines der beiden
nicht exzellent zu nennen, wäre unangebracht --, so kommt doch das Druckbild von
\textit{LilyPond} einen Tick 'augenfreundlicher' daher.

Musikwissenschaftler werden gut mit \textit{LilyPond} 'klarkommen': diese
Notationsweise zu lernen, ist einfach, sie anzuwenden leicht. In dieser Hinsicht
bietet \textit{LilyPond} mehr als MusiX\TeX. Und im Verbund mit
\acc{harmonyli.ly} wird \textit{LilyPond} auf höchstem Niveau zu einem vom
Forschungsgegenstand her adäquaten Tool für Musikwissenschaftler.



% this is only inserted to eject fault messages in texlipse
%\bibliography{../bib/literature}
