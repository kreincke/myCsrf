% mycsrf cloak file
%
% (c) Karsten Reincke, Frankfurt a.M. 2010, 2011, ff.
%
% This file is licensed under the Creative Commons Attribution 3.0 Germany
% License (http://creativecommons.org/licenses/by/3.0/de/): 
% For details see teh file LICENSE in the top directory
%
% select the document class
% S.26: [ 10pt|11pt|12pt onecolumn|twocolumn oneside|twoside notitlepage|titlepage final|draft
%         leqno fleqn openbib a4paper|a5paper|b5paper|letterpaper|legalpaper|executivepaper openrigth ]
% S.25: { article|report|book|letter ... }
%
% oder koma-skript S.10 + 16
\documentclass[
  DIV=calc,
  BCOR=5mm,
  12pt,
  headings=small,
  twoside,
  abstract=true,
  toc=bib,
  xcolor=dvipsnames,
  openany,
  english,ngerman]{scrbook}
  
%%% (1) general configurations %%%
\usepackage[utf8]{inputenc}

%%% (2) language specific configurations %%%
\usepackage[]{a4,babel}
\selectlanguage{ngerman}

% package for improving the grey value and the line feed handling
\usepackage{microtype}

%language specific quoting signs
\usepackage{csquotes}

% jurabib configuration
\usepackage[see]{jurabib}
\bibliographystyle{jurabib}
\input{cfg/inc.jbib-cfg.tex}

% language specific hyphenation
\input{cfg/inc.hyphenations.tex}

%%% (3) layout page configuration %%%

% select the visible parts of a page
% S.31: { plain|empty|headings|myheadings }
%\pagestyle{myheadings}
\pagestyle{headings}

% select the wished style of page-numbering
% S.32: { arabic,roman,Roman,alph,Alph }
\pagenumbering{arabic}
\setcounter{page}{1}

% select the wished distances using the general setlength order:
% S.34 { baselineskip| parskip | parindent }
% - general no indent for paragraphs
\setlength{\parindent}{0pt}
\setlength{\parskip}{1.2ex plus 0.2ex minus 0.2ex}


%%% (4) general package activation %%%
%\usepackage{utopia}
%\usepackage{courier}
%\usepackage{avant}
\usepackage[dvips]{epsfig}

% graphic

\usepackage{array}
\usepackage{shadow}
\usepackage{fancybox}

\usepackage{amsmath}
\usepackage{amsfonts}


\usepackage{chngcntr}


%- start(footnote-configuration)

\deffootnote[1.5em]{1.5em}{1.5em}{\textsuperscript{\thefootnotemark)\ }}

% if document class = book: count footnotes from start to end
\counterwithout{footnote}{chapter}
%- end(footnote-configuration)



%for using label as nameref
\usepackage{nameref}

%integrate nomenclature
\input{cfg/inc.ncl-meta.tex}

% depth of contents
\setcounter{secnumdepth}{5}
\setcounter{tocdepth}{5}

% Hyperlinks
\usepackage[breaklinks=true]{hyperref}
\hypersetup{bookmarks=true,breaklinks=true,colorlinks=true,citecolor=blue,draft=false}
\newcommand{\lnka}[1]{\href{#1}{\texttt{#1}}}
\newcommand{\lnkb}[2]{\href{#1}{\texttt{#1} (RDL: #2)}}

\usepackage{amssymb}

\usepackage{wasysym}
\usepackage{harmony}
\usepackage{musicography}
\usepackage{abc}
\usepackage{musixtex}
\usepackage{graphicx,color}
\usepackage{tabulary}
\usepackage{longtable}
\usepackage{threeparttablex}

% package for macking tables with broken lines
\usepackage{multirow}
\usepackage{ulem}
\usepackage{picins}

\usepackage[dvipsnames,table,xcdraw]{xcolor}
\usepackage{pgf}
\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{shapes,snakes}

%\usepackage{bigfoot}
\usepackage{verbatimbox}

% Unfortunately musixtex still uses outdated commands for
% establishing its own \bar command. Hence for enabling
% the use of musixtex we must 'redefine' these outdated commands:
\makeatletter
\DeclareOldFontCommand{\rm}{\normalfont\rmfamily}{\mathrm}
\DeclareOldFontCommand{\sf}{\normalfont\sffamily}{\mathsf}
\DeclareOldFontCommand{\tt}{\normalfont\ttfamily}{\mathtt}
\DeclareOldFontCommand{\bf}{\normalfont\bfseries}{\mathbf}
\DeclareOldFontCommand{\it}{\normalfont\itshape}{\mathit}
\DeclareOldFontCommand{\sl}{\normalfont\slshape}{\@nomath\sl}
\DeclareOldFontCommand{\sc}{\normalfont\scshape}{\@nomath\sc}
\makeatother 

\newcommand{\cadlab}[2]{Candenza-#1-#2}

\newcommand{\cad}[2]{
  \begin{flushright}\scshape\label{\cadlab{#1}{#2}}Cadenza-#1: #2\end{flushright}
}
\newcommand{\pnotes}[1]{\notes}

\newcommand{\acc}[0]{\textit}
\newcommand{\ra}[0]{$\rightarrow$}


% -- Basic Colors ---
% LilyPond colors:
\newcommand{\lyColor}[0]{RoyalBlue}
\newcommand{\lyBgColor}[0]{RoyalBlue!10}
% MusicXML colors:
\newcommand{\mxmlColor}[0]{OliveGreen}
\newcommand{\mxmlBgColor}[0]{OliveGreen!10}
% ABC colors:
\newcommand{\abcColor}[0]{Plum}
\newcommand{\abcBgColor}[0]{Plum!10}

% PMX colors:
\newcommand{\pmxColor}[0]{Orange}
\newcommand{\pmxBgColor}[0]{Orange!10}

% MusiXTeX colors:
\newcommand{\mtexColor}[0]{Magenta}
\newcommand{\mtexBgColor}[0]{Magenta!10}

% Xtra colors
\newcommand{\multiBgColor}[0]{Black!10}
\newcommand{\pdfBgColor}[0]{Gray!10}
\newcommand{\backendBgColor}[0]{Yellow!10}

% -- IO Colors ---

\newcommand{\abcInColor}[0]{\abcBgColor}
\newcommand{\abcOutColor}[0]{\abcColor}

\newcommand{\mxmlInColor}[0]{\mxmlBgColor}
\newcommand{\mxmlOutColor}[0]{\mxmlColor}

\newcommand{\lyInColor}[0]{\lyBgColor}
\newcommand{\lyOutColor}[0]{\lyColor}

\newcommand{\pmxInColor}[0]{\pmxBgColor}
\newcommand{\pmxOutColor}[0]{\pmxColor}

\newcommand{\mtexInColor}[0]{\mtexBgColor}
\newcommand{\mtexOutColor}[0]{\mtexColor}

% -- Node types---

\newcommand{\converter}[6]{
  \node[trapezium stretches body, 
  fill=#1, text=#2] (#3) at (#4,#5) { \textbf{\sffamily{#6}} };
}

\newcommand{\backend}[6]{
  \node[trapezium stretches body, align=center, minimum height=0.75cm,
  fill=\backendBgColor, text=#2] (#3) at (#4,#5) { \textbf{#6}\\#1};
}

\newcommand{\file}[6]{ 
  \node[rectangle,draw,text width=1cm, 
  fill=#1, text=#2] (#3) at (#4,#5) {\centering{\textbf{\ttfamily{#6}}}};
}

\newcommand{\frontend}[7]{
  \node[rectangle, align=center, rounded corners, minimum height=0.75cm,
  fill=#1, text=#2] (#3) at (#4,#5) { \textbf{#6}\\#7 };
}


\begin{document}

%% use all entries of the bliography
\nocite{*}

%%-- start(titlepage)
\titlehead{\textit{mycsrf} und Musik}
\subject{Release \input{inc.rel.tex}}
\title{Musikwissenschaft mit \LaTeX}
\subtitle{Wie man Musikbeispiele mit Open-Source-Tools 
in seine wissenschaftliche Texte integriert.\\
{\small Eine selbstreferentielle Anleitung}}
\author{Karsten Reincke}

%thanks entry cannot be combined with license footnote
%\thanks{den Autoren von KOMA-Script und denen von Jurabib}

\maketitle
%%-- end(titlepage)

\textit{Dieses Tutorial erläutert, wie man musikalische Beispiele mit
Open-Source-Mitteln in \LaTeX-Texte einbettet. Dazu sichtet es Notensatzsysteme,
Editoren, Konverter und Tools, die Notentexte erzeugen, verändern und in den
\LaTeX-Text integrieren. Und es skizziert, wie man ganze 'Produktionsketten' aus
Frontendsystemen, Konvertern und Backendsystemen 'zusammenstöpselt'. Zuletzt
entsteht so eine 'Landkarte' verschiedener Wege.\input{cfg/inc.license-fn.tex}
}

\addchap{Vorwort}
\input{snippets/inc.vorwort.tex}

\footnotesize
\tableofcontents

\normalsize
\setcounter{chapter}{-1}
\chapter{Der Kontext}

\input{snippets/inc.anliegen.tex}

\input{snippets/inc.kriterien.tex}

\chapter{Leichtgewichtige Teillösungen}

Selbstverständlich wird sich zuletzt herausstellen, dass adäquate Systeme zur
Erfassung von Musik eine gewisse Komplexität mitbringen. Das liegt in der Natur
der Sache: Musik ist zweidimensional.\footnote{Bei der Notation von Musik hatten
wir gesagt, dass sie zweidimensional oder eindimensional codiert sein könne.
Als Abfolge(sic!) von Klängen(sic!) ist sie selbst aber immer (mindestens)
zweidimensional.} Das hat einige Autoren nicht entmutigt, wenigstens für
Teilaufgaben einfachere Lösungen zu entwickeln, die im freien Textsatzsystem
\LaTeX\footnote{Bzgl. der Zusammenhänge von \TeX, \LaTeX, pdf\LaTeX\ und
Lua\LaTeX\ vlg. etwa \cite[][7ff]{Voss2018a} oder \cite[][8ff]{Voss2012a}.
Daraus ergibt sich mittelbar auch der Open-Source-Status von \LaTeX: \TeX\ und
\LaTeX\ sind zunächst einmal 'nur' eine Metasprache. Um aus Dateien, die in
dieser Auszeichnungssprache formuliert sind, typographisch gestaltete \acc{DVI}-
oder \acc{PDF}-Dateien zu erzeugen, bedarf des bestimmter Programme, nämlich
\texttt{pdflatex}, \texttt{lualatex}\ etc. Außerdem hat sich um \LaTeX\ herum ein
Biotop von Paketen entwickelt. Das sind fertig vorbereitete \TeX- oder
\LaTeX-Dateien, die man in seine eigenen Dokumente einbindet und also mitnutzt.
Solche Pakete stehen -- mit den Kernprogrammen gebündelt -- als komplette
\TeX-Distributionen bereit. Für den europäischen Raum existieren z.Zt. zwei
wesentliche Distributionen, \acc{{\TeX}live} und \acc{MiK{\TeX}}. Diese findet
man im \acc{Comprehensive TeX Archive Network} ($\rightarrow$
\href{https://ctan.org/}{https://ctan.org/}). Der unbedarfte Anwender tut aber
gut daran, sich vorbereitete Installationspakete von sekundären Distributoren zu
holen. \acc{Linux}-Distributionen liefern diese i.d.R. mit. Ob man sein
\LaTeX-System lizenzkonform nutzt, entscheidet also die Lizensierung der
Kernprogramme und die Lizenzen der eingebundenen Pakete. Diese müssen nicht
unter derselben Lizenz veröffentlicht sein. Glücklicherweise werden beide -- die
Kernprogramme und die Erweiterungen -- als \acc{CTAN}-Pakete gehostet und unter
den Bedingungen verschiedener FOSS-Lizenzen zum Download angeboten. So ist etwa
pdf\LaTeX\ unter der GPL lizenzisiert ($\rightarrow$
\href{https://ctan.org/pkg/pdftex} {https://ctan.org/pkg/pdftex}). Ganz
allgemein gesagt, darf man alles, was zu \LaTeX\ gehört, als freie Software
nutzen. Wir werden bei den Paketen jedoch kurz angeben, unter welcher Lizenz sie
genau stehen.} genutzt werden können.
Diesen werden wir zuerst nachgehen. Behalten wir aber im Hinterkopf:
\acc{Komplexität ist wie Wasser, man kann es nicht
komprimieren.}\footnote{Dieses wunderbare Bonmot stammt nicht von mir. Und
bedauerlicherweise weiß ich auch nicht (mehr) von wem. Ich meine es etwa Anfang
der 2010er Jahre in einer Keynote bei der Deutschen Telekom in Darmstadt gehört
zu haben. Ich verbeuge mich also dankbar vor dem mir leider unbekannten Autor.}


\input{snippets/inc.sonderzeichen.tex}

\input{snippets/inc.wasysym.tex}
 
\input{snippets/inc.musicography.tex}

\input{snippets/inc.harmony.tex}

\chapter{Backends: Komplexe Notationssysteme}

\input{snippets/inc.abc.tex}

\input{snippets/inc.musixtex.tex}

\input{snippets/inc.pmx.tex}

\input{snippets/inc.lilypond.tex}

\input{snippets/inc.graphics.tex}

\input{snippets/inc.mup.tex} 
\input{snippets/inc.texmuse.tex}

\chapter{Frontends: die (graphische) Eingabe}

Abgesehen von der letzten Variante, werden bei den hier diskutierten Methoden
die Noten zuletzt textbasiert codiert: um zu komponieren oder zu arrangieren
benötigt man einen Texteditor. Dessen Output wird \acc{ABC}, \acc{LilyPond}, 
\acc{MusiX\TeX}\ oder \acc{PMX} als die Backendsysteme übergeben, die daraus
den eigentlichen Notentext erzeugen.

Die Arbeit mit reinen Texteditoren ist nicht das, was man unter einer
musikerfreundlichen Arbeitsumgebung verstehen würde. Die Sprache der Musiker
sind Noten, keine mehr oder minder kryptischen Syntagmen. Und so gibt es denn
auch eine Reihe von graphischen Programmen, bei denen der Musiker entweder Noten
'schreibt', nicht Text, oder bei denen seine Texteingaben wenigstens unmittelbar
visualisiert werden, ohne dass er zuvor selbst das Backend aufrufen müssten.
Erstere bezeichnen wir als graphische oder visuelle Editoren, letztere als
semi-graphische.\footnote{Für den unbedarften Nutzer sieht es manchmal so aus,
als sei die Erzeugung des Notentextes integrierter Bestandteil des Frontends.
Wäre dem so, schiene der Begriff 'Editor' irgendwie ungerecht. Tatsächlich
verküpfen solche 'integrierten Entwicklungsumgebungen' meist aber den Editor
'nur' sehr geschickt mit der eigentlichen 'Notengenerierungsmaschine', dem
Backend. Deshalb ist es in unserem Kontext sehr wohl sinnvoll, von Backends und
Frontends zu sprechen und unter letzteren im Wesentlichen Editoren zu verstehen,
die die eingebenen Daten in verschiedenen Formaten abzuspeichern vermögen, --
selbst wenn sie sich selbst eher als IDE, als \acc{Integrated Development
Environment} verstehen.}

Damit darf man fragen, ob und wie man Opensource-Notensatzprogramme dazu nutzen
kann, den zuletzt im \LaTeX-Dokument benötigten Code aus dem abzuleiten, was man
in und mit diesen Editoren eingegeben. Diese Frage ist im Einzelfall -- und
nicht nur für Opensourceprogramme -- einfach zu beantworten:

\begin{itemize}
\item Zum einen muss man überprüfen, ob es der Editor erlaubt, den Inhalt in
einem der benötigten Formate zu speichern.
\item Und zum anderen muss man testen, ob der Editor den Inhalt auch
hinreichend 'verlustfrei' exportiert.
\end{itemize}

Dem werden wir nachgehen. Allerdings wollen wir noch etwas vorausschicken:

Frontends von Notensatzsystemen nutzen meist ein natives Dateiformat und
exportieren ihren Inhalt ggfls. in Fremdformate. Sie agieren implizit als
Konverter. Daneben gibt es noch eine Reihe von expliziten Konvertern, die eine
Datei in dem einen Format einlesen und in einem anderen wieder abspeichern.

Sollte also ein Notensatzprogramm von sich aus das eine oder andere der in
unserem Kontext benötigten Formate nicht oder nur unzureichend exportieren,
bliebe immer noch die Möglichkeit, einen eigenständigen Konverter
zwischenzuschalten. Zu wissen, welche expliziten Konverter es (in welcher
Qualität) gibt, könnte mithin die Anzahl der gut zu nutzenden Notensatzsysteme
erhöhen.\footnote{Wollte man diesem Gedanken in letzter Konsequenz nachgehen,
müsste man zunächst eine Liste aller Notationsformate erstellen und dann nach
Konvertern suchen, die diese 'anderen' auf die Formate \textit{ABC},
\textit{Musix\TeX}, \textit{PMX} oder \textit{LilyPond} abbilden. Das kann beliebig
komplex werden. Wir konzentrieren uns hier auf die freie Software. Formate, die
proprietäre Programme verwenden, geraten also gar nicht erst in unseren Blick.
Von daher würde eine Übersicht der Konverter, die wir erstellen, niemals alle
Wege abdecken. Insofern erlauben wir uns, die Konverter 'nur' kursorisch zu
sichten.}


\input{snippets/inc.converter.tex}

\input{snippets/inc.editoren.tex}

\input{snippets/inc.exkurs-midi.tex}

\section{Editoren II}

\input{snippets/inc.abcj.tex} 

\input{snippets/inc.aria.tex} 

\input{snippets/inc.audimus.tex}
\newpage
\input{snippets/inc.brahms.tex} 

\input{snippets/inc.canorus.tex} 

\input{snippets/inc.denemo.tex} 

\input{snippets/inc.easyabc.tex} 

\input{snippets/inc.elysium.tex} 

\input{snippets/inc.freeclef.tex}

\input{snippets/inc.frescobaldi.tex} 

\input{snippets/inc.jniz.tex}

\input{snippets/inc.laborejo.tex} 

\input{snippets/inc.musedit.tex} 

\input{snippets/inc.musescore.tex} 

\input{snippets/inc.mux2d.tex} 

\input{snippets/inc.noteedit.tex} 
 
\input{snippets/inc.nted.tex} 

\input{snippets/inc.ptolemaic.tex} 

\input{snippets/inc.rosegarden.tex} 

\input{snippets/inc.converterii.tex}

\chapter{Vom Frontend nach \LaTeX: die Toolketten}
\input{snippets/inc.toolchain-survey.tex} 
\input{snippets/inc.toolchain-evaluation.tex} 
\input{snippets/inc.toolchain-comparison.tex} 

\chapter{Fazit}

%\input{snippets/inc.appendices.tex}
% insert the nomenclature here

\input{bib/ncl.abbreviations.tex}
%\input{bib/ncl.journals}
\printnomenclature

% insert the bibliographical data here
\bibliography{bib/literature}

\end{document}
